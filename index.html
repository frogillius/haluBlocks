<!DOCTYPE html>
<html>
<head>
    <title>SVG Path Generator</title>
    <style>
        body { font-family: sans-serif; }
        textarea { width: 100%; height: 150px; box-sizing: border-box; margin-bottom: 10px; }
        #svgOutput { border: 1px solid #ccc; margin-bottom: 10px; display: block; }
        #svgCodeOutput { width: 100%; height: 100px; box-sizing: border-box; font-family: monospace; font-size: 12px; }
        .input-section { margin-bottom: 20px; }
        .svg-container { width: 400px; height: 300px; border: 1px solid #ddd; margin-bottom: 10px; }
        .svg-container svg { width: 100%; height: 100%; }
    </style>
</head>
<body>
    <h1>SVG Path Generator</h1>

    <div class="input-section">
        <h2>Input JSON from File</h2>
        <input type="file" id="jsonFileUpload" accept=".json">
    </div>

    <div class="input-section">
        <h2>Input JSON Manually</h2>
        <textarea id="jsonTextInput" placeholder='Enter JSON here...'></textarea>
    </div>

    <button onclick="generatePath()">Generate SVG Path</button>

    <div class="svg-container">
        <h2>SVG Output</h2>
        <div id="svgOutput">
            <!-- SVG Path will be displayed here -->
        </div>
    </div>

    <h2>SVG Code</h2>
    <textarea id="svgCodeOutput" readonly placeholder="Generated SVG code will appear here"></textarea>

    <script src="./generator/coder.js"></script>
    <script>
        const pathGenerator = new SVGPathGenerator(); // Instantiate the class

        async function generatePath() {
            let jsonString = "";
            const fileUpload = document.getElementById('jsonFileUpload');
            const textInput = document.getElementById('jsonTextInput');
            const svgOutputDiv = document.getElementById('svgOutput');
            const svgCodeTextarea = document.getElementById('svgCodeOutput');

            if (fileUpload.files.length > 0) {
                const file = fileUpload.files[0];
                jsonString = await readFileAsText(file);
            } else if (textInput.value.trim() !== "") {
                jsonString = textInput.value;
            } else {
                alert("Please input JSON either via file upload or in the text area.");
                return;
            }

            try {
                const svgElement = pathGenerator.generateSvgPathElementFromJson(jsonString);
                svgOutputDiv.innerHTML = svgElement; // Set SVG element to the div
                svgCodeTextarea.value = svgElement;    // Set SVG code to textarea
            } catch (error) {
                console.error("Error generating SVG:", error);
                alert("Error generating SVG path. Please check the JSON input.");
                svgOutputDiv.innerHTML = '<p style="color:red;">Error displaying SVG. Check console for details.</p>';
                svgCodeTextarea.value = "Error generating SVG. See console.";
            }
        }

        function readFileAsText(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => resolve(reader.result);
                reader.onerror = () => reject(reader.error);
                reader.readAsText(file);
            });
        }
    </script>
</body>
</html>
